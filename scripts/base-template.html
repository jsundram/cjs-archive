<html>
  <head>
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
    <link
      rel="stylesheet"
      as="style"
      onload="this.rel='stylesheet'"
      href="https://fonts.googleapis.com/css2?display=swap&amp;family=Inter%3Awght%40400%3B500%3B700%3B900&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900"
    />

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{meta_title}</title>
    <meta name="description" content="{meta_description}">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://clarencesundram.org/{canonical_url}">

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">

    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4.1.8/dist/index.global.min.js"></script>

    <!-- MiniSearch for client-side search -->
    <script src="https://cdn.jsdelivr.net/npm/minisearch@6.3.0/dist/umd/index.min.js"></script>
  </head>
  <body>
    <div class="relative flex size-full min-h-screen flex-col bg-gray-50 group/design-root overflow-x-hidden" style='font-family: Inter, "Noto Sans", sans-serif;'>
      <div class="layout-container flex h-full grow flex-col">
        <header class="relative flex items-center justify-between whitespace-nowrap border-b border-solid border-b-[#e9edf1] px-4 md:px-10 py-3">
          <div class="flex items-center gap-4 text-[#101419]">
            <!-- Hamburger Button -->
            <button
              id="hamburger-btn"
              class="flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-xl h-10 bg-[#e9edf1] text-[#101419] gap-2 text-sm font-bold leading-normal tracking-[0.015em] min-w-0 px-2.5"
            >
              <div class="text-[#101419]" data-icon="List" data-size="20px" data-weight="regular">
                <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" fill="currentColor" viewBox="0 0 256 256">
                  <path
                    d="M224,128a8,8,0,0,1-8,8H40a8,8,0,0,1,0-16H216A8,8,0,0,1,224,128ZM40,72H216a8,8,0,0,0,0-16H40a8,8,0,0,0,0,16ZM216,184H40a8,8,0,0,0,0,16H216a8,8,0,0,0,0-16Z"
                  ></path>
                </svg>
              </div>
            </button>
            <h2 id="site-title" class="text-[#101419] text-lg font-bold leading-tight tracking-[-0.015em]">Archive</h2>
          </div>
          <div class="flex flex-1 justify-end gap-8">
            <!-- Navigation Menu -->
            <nav id="main-nav" class="hidden flex flex-col gap-4
                                      absolute top-full left-0 right-0
                                      bg-white border-b border-solid border-b-[#e9edf1] px-4 md:px-10 py-4">
              <a class="text-[#101419] text-sm font-medium leading-normal hover:bg-gray-100 hover:text-[#0066cc] px-2 py-1 rounded transition-colors duration-200" href="{path_prefix}index.html">About</a>
              <a class="text-[#101419] text-sm font-medium leading-normal hover:bg-gray-100 hover:text-[#0066cc] px-2 py-1 rounded transition-colors duration-200" href="{path_prefix}cqc.html">Commission on Quality of Care</a>
              <a class="text-[#101419] text-sm font-medium leading-normal hover:bg-gray-100 hover:text-[#0066cc] px-2 py-1 rounded transition-colors duration-200" href="#">Special Master</a>
              <a class="text-[#101419] text-sm font-medium leading-normal hover:bg-gray-100 hover:text-[#0066cc] px-2 py-1 rounded transition-colors duration-200" href="{path_prefix}court-monitor.html">Court Monitor</a>
              <a class="text-[#101419] text-sm font-medium leading-normal hover:bg-gray-100 hover:text-[#0066cc] px-2 py-1 rounded transition-colors duration-200" href="{path_prefix}special-advisor.html">Special Advisor</a>
            </nav>
            <!-- Search Button -->
            <button
              id="search-btn"
              class="flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-xl h-10 bg-[#e9edf1] text-[#101419] gap-2 text-sm font-bold leading-normal tracking-[0.015em] min-w-0 px-2.5"
              title="Search documents"
            >
              <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" fill="currentColor" viewBox="0 0 256 256">
                <path d="M229.66,218.34l-50.07-50.06a88.11,88.11,0,1,0-11.31,11.31l50.06,50.07a8,8,0,0,0,11.32-11.32ZM40,112a72,72,0,1,1,72,72A72.08,72.08,0,0,1,40,112Z"></path>
              </svg>
            </button>
            <div
              class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10"
              style='background-image: url("{path_prefix}assets/headshot.jpg");'
            ></div>
          </div>
        </header>

        {breadcrumb}

        <div class="bg-white border-b border-solid border-b-[#e9edf1] px-4 md:px-10 py-4">
          <h1 id="page-title" class="text-[#101419] text-xl font-bold leading-tight tracking-[-0.015em]">{page_title}</h1>
        </div>

        {content}

      </div>
    </div>

    <!-- Search Modal -->
    <div id="search-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-start justify-center pt-20">
      <div class="bg-white rounded-lg shadow-xl w-full max-w-2xl mx-4">
        <div class="p-6">
          <div class="flex items-center justify-between mb-4">
            <h2 class="text-xl font-bold text-[#101419]">Search Documents</h2>
            <button id="close-search" class="text-[#58728d] hover:text-[#101419]">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 256 256">
                <path d="M205.66,194.34a8,8,0,0,1-11.32,11.32L128,139.31,61.66,205.66a8,8,0,0,1-11.32-11.32L116.69,128,50.34,61.66A8,8,0,0,1,61.66,50.34L128,116.69l66.34-66.35a8,8,0,0,1,11.32,11.32L139.31,128Z"></path>
              </svg>
            </button>
          </div>
          <input
            type="text"
            id="search-input"
            placeholder="Search by title, description, or category..."
            class="w-full px-4 py-3 border border-[#d3dbe4] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#1971c2] text-[#101419]"
          />
          <div id="search-results" class="mt-4 max-h-96 overflow-y-auto"></div>
        </div>
      </div>
    </div>

    <script>
      // Hamburger menu functionality
      const hamburgerBtn = document.getElementById('hamburger-btn');
      const mobileMenu = document.getElementById('main-nav');

      hamburgerBtn.addEventListener('click', function(e) {
        e.stopPropagation();
        if (mobileMenu.classList.contains('hidden')) {
          mobileMenu.classList.remove('hidden');
        } else {
          mobileMenu.classList.add('hidden');
        }
      });

      document.addEventListener('click', function(e) {
        if (!mobileMenu.classList.contains('hidden') &&
            !mobileMenu.contains(e.target) &&
            !hamburgerBtn.contains(e.target)) {
          mobileMenu.classList.add('hidden');
        }
      });

      mobileMenu.addEventListener('click', function(e) {
        e.stopPropagation();
      });

      // Set page title from document title
      if (document.getElementById('page-title') && !document.getElementById('page-title').textContent) {
        document.getElementById('page-title').textContent = document.title;
      }

      // Search functionality
      let miniSearch = null;
      let searchIndexLoaded = false;

      // Load search index
      fetch('{path_prefix}search-index.json')
        .then(response => response.json())
        .then(documents => {
          miniSearch = new MiniSearch({
            fields: ['title', 'description', 'category', 'source'],
            storeFields: ['title', 'description', 'category', 'date', 'section', 'url'],
            searchOptions: {
              boost: { title: 2 },
              fuzzy: 0.2,
              prefix: true
            }
          });
          miniSearch.addAll(documents);
          searchIndexLoaded = true;
        })
        .catch(error => console.error('Error loading search index:', error));

      // Search modal controls
      const searchBtn = document.getElementById('search-btn');
      const searchModal = document.getElementById('search-modal');
      const closeSearch = document.getElementById('close-search');
      const searchInput = document.getElementById('search-input');
      const searchResults = document.getElementById('search-results');

      searchBtn.addEventListener('click', () => {
        searchModal.classList.remove('hidden');
        searchInput.focus();
      });

      closeSearch.addEventListener('click', () => {
        searchModal.classList.add('hidden');
        searchInput.value = '';
        searchResults.innerHTML = '';
      });

      searchModal.addEventListener('click', (e) => {
        if (e.target === searchModal) {
          searchModal.classList.add('hidden');
          searchInput.value = '';
          searchResults.innerHTML = '';
        }
      });

      // Escape key to close
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && !searchModal.classList.contains('hidden')) {
          searchModal.classList.add('hidden');
          searchInput.value = '';
          searchResults.innerHTML = '';
        }
      });

      // Search on input
      searchInput.addEventListener('input', (e) => {
        const query = e.target.value.trim();

        if (!searchIndexLoaded) {
          searchResults.innerHTML = '<p class="text-[#58728d] p-4">Loading search index...</p>';
          return;
        }

        if (query.length < 2) {
          searchResults.innerHTML = '';
          return;
        }

        const results = miniSearch.search(query, { limit: 20 });

        if (results.length === 0) {
          searchResults.innerHTML = '<p class="text-[#58728d] p-4">No results found.</p>';
          return;
        }

        const resultsHTML = results.map(result => {
          const doc = result;
          return `
            <a href="{path_prefix}${doc.url}" class="block p-4 hover:bg-gray-50 border-b border-[#e9edf1]">
              <h3 class="font-bold text-[#101419] mb-1">${doc.title}</h3>
              ${doc.description ? `<p class="text-sm text-[#58728d] mb-2">${doc.description.substring(0, 150)}${doc.description.length > 150 ? '...' : ''}</p>` : ''}
              <div class="flex gap-2 text-xs">
                ${doc.category ? `<span class="px-2 py-1 bg-[#e9edf1] text-[#101419] rounded">${doc.category}</span>` : ''}
                ${doc.date ? `<span class="text-[#58728d]">${doc.date}</span>` : ''}
              </div>
            </a>
          `;
        }).join('');

        searchResults.innerHTML = resultsHTML;
      });
    </script>
  </body>
</html>
